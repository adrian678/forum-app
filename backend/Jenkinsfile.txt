environment {
    registry = "adrian678/forum-backend"
}

node {
    def app

    stage('Clone repo') {
        checkout scm
    }

    stage('Build backend image') {
        /* need to move to backend dir */
        dir("backend"){
            def dockerfile = 'backend.Dockerfile'
            app = docker.build(${registry}:${env.BUILD_ID}", " -f ${dockerfile} .")
        }
    }

    stage('Push backend image') {
        /* comment for commit */
        app.push()

    }
}